{% extends 'account/account.html' %}
{% block headertitle %}<title>VetCove | Bonuses</title>{% endblock%}
{% block bonus %}active{% endblock %}

{% block jsblock %}
<script src="{{STATIC_URL}}js/bootstrap-tagsinput.js" type="text/javascript" ></script>
<script type="text/javascript">
//Used to make every space a new tag
$(document).ready(function () {
	$('.bootstrap-tagsinput').on('input', function() {
    	redrawContacts(false);
	});
	$('#referral-form').submit(function() {
    	redrawContacts(true);
    	return true;
	});
});

var redrawContacts = function(combined) {
	var value = String($("#emails").tagsinput("items"));
	if (combined) {
		var value = String($("#emails").tagsinput("items"))+","+$('.bootstrap-tagsinput input').val();
		$('.bootstrap-tagsinput input').val("");
		console.log("col");
	}
	var value = value.split(/,| /);
	$('#emails').tagsinput('removeAll');
	for (var itm=0;itm<value.length;itm++) {
		$("#emails").tagsinput('add', value[itm]);
	}
}
</script>
{% endblock %}
{% block maintitle %}Refer Friends{% endblock %}
{% block headersubcss %}
<link href="{{STATIC_URL}}css/bootstrap-tagsinput.css" rel="stylesheet" type="text/css" />
<style>
.bonus-container {
	padding: 40px 20px;
}
.bonus-title {
	margin: 0px 30px 25px 30px;
	padding-bottom: 25px;
	text-align: center;
}
.bonus-title h4 {
	font-size: 30px;
	font-weight: 200;
	line-height: 40px;
}
.bootstrap-tagsinput {
	width: 100%;
	min-height: 100px;
}
.bootstrap-tagsinput .tag {
	font-size: 13px;
	line-height: 25px;
}
.bootstrap-tagsinput input {
	min-width: 150px;
}
.referral-link {
	border-top:1px solid #eee;
	margin-top: 35px;
	padding-top: 20px;
}
.disclaimer p {
	font-size: 12px;
	color: #777;
	padding: 40px 40px 0 40px;
	text-align: center;
}
</style>
{% endblock %}
{% block maincontent %}
	<div class="maincontent-container covebox bonus-container">
		<div class="bonus-title">
			<h4>Send your friends a free <strong>$10</strong> discount</h4>
			<p>(If they make a purchase, you earn $10 too!)</p>
		</div>
		{% if not success %}
		<div class="referral-option row">
			<form id="referral-form" method="POST" action="/account/referralform">{% csrf_token %}
				<p>Type or paste the names of any friends or colleagues who would benefit from VetCove:</p>
    			<input id="emails" type="text" value="" name="emails" data-role="tagsinput" placeholder="Add Email Addresses" />
				<button class="button button-rounded button-action">Send Discounts</button>
			</form>
		</div>
		{% else %}
		<div class="referral-option row">
			<h5>We have sent the discounts.</h5>
			<p>For every friend that signs up and makes a purchase, we will credit $10 to your account, which will automatically be applied at checkout.</p>
		</div>
		{% endif %}
		<div class="referral-option referral-link row">
			<p>More ways to share:</p>
			<p>Referral Link: <strong>www.vetcove.com/referral/{{user.basicuser.referral_id}}</strong></p>
		</div>
		<div class="disclaimer">
			<p>You can see which friends have made purchases in your <a href="/account/bonushistory">pending referrals</a></p>
		</div>
	</div>
  		
{% endblock %}